<?php

/*
 * Copyright (C) 2017 Anders LÃ¶vgren (QNET).
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

?>
<style>
    .sitemap a {
        text-decoration: none;
    }
    .sitemap-icon {
        color: deepskyblue;
    }
    ul.sitemap {
        list-style-type: none;
    }
</style>

<?php

function render_node_item($node, $icon)
{
        printf("<li><i class=\"fa $icon sitemap-icon w3-text-blue\" aria-hidden=\"true\"></i><a href=\"%s\"> %s</a></li>\n", $node->getPath(), $node->getName());
}

function render_root_node($node)
{
        printf("<ul class=\"sitemap\">\n");
        render_node_item($node, "fa-globe");
        if ($node->hasChildren()) {
                render_children($node);
        }
        printf("</ul>\n");
}

function render_child_node($node)
{
        render_node_item($node, "fa-plus-square-o");
        if ($node->hasChildren()) {
                render_children($node);
        }
}

function render_child_leaf($node)
{
        render_node_item($node, "fa-minus-square-o");
}

function render_children($node)
{
        printf("<ul class=\"sitemap\">\n");
        foreach ($node->getChildren() as $child) {
                if ($child->isDisplayable() == false) {
                        continue;
                }
                if ($child->hasChildren()) {
                        render_child_node($child);
                } else {
                        render_child_leaf($child);
                }
        }
        printf("</ul>\n");
}

render_root_node($this);
